{"version":3,"file":"vue3-update-listener.umd.min.js","mappings":"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","sources":["webpack://vue3-update-listener/webpack/universalModuleDefinition","webpack://vue3-update-listener/./node_modules/vue-loader/dist/exportHelper.js","webpack://vue3-update-listener/external umd {\"commonjs\":\"vue\",\"commonjs2\":\"vue\",\"root\":\"Vue\"}","webpack://vue3-update-listener/webpack/bootstrap","webpack://vue3-update-listener/webpack/runtime/define property getters","webpack://vue3-update-listener/webpack/runtime/hasOwnProperty shorthand","webpack://vue3-update-listener/webpack/runtime/make namespace object","webpack://vue3-update-listener/webpack/runtime/publicPath","webpack://vue3-update-listener/./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js","webpack://vue3-update-listener/./packages/updateListener/utils/modalPromise.js","webpack://vue3-update-listener/./packages/updateListener/components/confirm/index.vue","webpack://vue3-update-listener/./packages/updateListener/components/confirm/qingmu.vue","webpack://vue3-update-listener/./packages/updateListener/layout/mask.vue","webpack://vue3-update-listener/./packages/updateListener/layout/mask.vue?8eeb","webpack://vue3-update-listener/./packages/updateListener/mixins/default.js","webpack://vue3-update-listener/./packages/updateListener/components/confirm/qingmu.vue?d073","webpack://vue3-update-listener/./packages/updateListener/components/confirm/element.vue","webpack://vue3-update-listener/./packages/updateListener/components/confirm/element.vue?8eb2","webpack://vue3-update-listener/./packages/updateListener/components/confirm/index.vue?37a2","webpack://vue3-update-listener/./packages/updateListener/components/confirm/confirm.js","webpack://vue3-update-listener/./packages/updateListener/index.js","webpack://vue3-update-listener/./packages/index.js","webpack://vue3-update-listener/./node_modules/@vue/cli-service/lib/commands/build/entry-lib.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vue\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"vue3-update-listener\"] = factory(require(\"vue\"));\n\telse\n\t\troot[\"vue3-update-listener\"] = factory(root[\"Vue\"]);\n})((typeof self !== 'undefined' ? self : this), function(__WEBPACK_EXTERNAL_MODULE__274__) {\nreturn ","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__274__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","/* eslint-disable no-var */\n// This file is imported into lib/wc client bundles.\n\nif (typeof window !== 'undefined') {\n  var currentScript = window.document.currentScript\n  if (process.env.NEED_CURRENTSCRIPT_POLYFILL) {\n    var getCurrentScript = require('@soda/get-current-script')\n    currentScript = getCurrentScript()\n\n    // for backward compatibility, because previously we directly included the polyfill\n    if (!('currentScript' in document)) {\n      Object.defineProperty(document, 'currentScript', { get: getCurrentScript })\n    }\n  }\n\n  var src = currentScript && currentScript.src.match(/(.+\\/)[^/]+\\.js(\\?.*)?$/)\n  if (src) {\n    __webpack_public_path__ = src[1] // eslint-disable-line\n  }\n}\n\n// Indicate to webpack that this file can be concatenated\nexport default null\n","/*\r\n * @Description: \r\n * @Author: 舌红\r\n * @Date: 2024-02-27 18:26:15\r\n * @LastEditors: 舌红\r\n * @LastEditTime: 2024-02-27 18:53:45\r\n */\r\n\r\n/**\r\n * modal调用promise化\r\n * @param {Object} comp Vue组件配置对象\r\n * @param {Object} defaultConfig 默认配置对象\r\n * @param {Element} mountedEl 挂载对象\r\n * @returns {Promise} Promise对象\r\n */\r\n\r\n// import Vue from 'vue'\r\nimport { createVNode, render } from 'vue'\r\n\r\nexport function modalPromise(comp, defaultConfig, mountedEl) {\r\n  return (config, removable = true) => {\r\n    return new Promise((resolve, reject) => {\r\n      const props = Object.assign({}, defaultConfig, config)\r\n      const vm = createVNode(comp, {\r\n        ...props,\r\n        onCancel: onCancel(reject),\r\n        onConfirm: onConfirm(resolve, removable)\r\n      }, null)\r\n\r\n      if (!mountedEl) {\r\n        mountedEl = document.body\r\n      }\r\n      render(vm, mountedEl)\r\n      \r\n      const parentNode = document.querySelector('.confirm-mask.update-confirm-loader')\r\n      \r\n      function onCancel() {\r\n        return function (data) {\r\n          parentNode && parentNode.remove()\r\n          reject(data)\r\n        }\r\n      }\r\n      \r\n      function onConfirm() {\r\n        return function (data) {\r\n          if (removable) {\r\n            parentNode && parentNode.remove()\r\n          }\r\n          resolve(data, this)\r\n        }\r\n      }\r\n    })\r\n  }\r\n}\r\n","<!--\r\n * @Description: \r\n * @Author: 舌红\r\n * @Date: 2024-02-20 09:46:22\r\n * @LastEditors: 舌红\r\n * @LastEditTime: 2024-02-27 16:33:32\r\n-->\r\n<template>\r\n  <component\r\n    :is=\"confirmTypeNames[type]\"\r\n    :content=\"content\"\r\n    @confirm=\"confirm\"\r\n    @cancel=\"cancel\"\r\n  />\r\n</template>\r\n\r\n<script>\r\nimport UpdateConfirmQingmu from './qingmu'\r\nimport UpdateConfirmElement from './element'\r\nimport DefaultMixins from '../../mixins/default'\r\n\r\nexport default {\r\n  name: 'UpdateConfirm',\r\n  components: {\r\n    UpdateConfirmQingmu,\r\n    UpdateConfirmElement\r\n  },\r\n  mixins: [DefaultMixins],\r\n  data() {\r\n    return {\r\n      confirmTypeNames: {\r\n        qingmu: 'UpdateConfirmQingmu',\r\n        element: 'UpdateConfirmElement'\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n</script>","<!--\r\n * @Description: \r\n * @Author: 舌红\r\n * @Date: 2024-02-19 11:59:50\r\n * @LastEditors: 舌红\r\n * @LastEditTime: 2024-02-23 14:44:36\r\n-->\r\n<template>\r\n  <ConfirmMask>\r\n    <div class=\"confirm-qingmu__body\">\r\n      <div class=\"confirm-qingmu__wrapper\">\r\n        <div class=\"confirm-qingmu__title\">\r\n          新版上线啦！\r\n        </div>\r\n        <div class=\"confirm-qingmu__content\">\r\n          <div class=\"confirm-qingmu__desc\">\r\n            {{ content }}\r\n          </div>\r\n        </div>\r\n        <div class=\"confirm-qingmu__footer\">\r\n          <div\r\n            class=\"confirm-qingmu__btn confirm-qingmu__btn--confirm\"\r\n            @click=\"confirm\"\r\n          >\r\n            立即更新\r\n          </div>\r\n          <div\r\n            class=\"confirm-qingmu__btn confirm-qingmu__btn--cancel\"\r\n            @click=\"cancel\"\r\n          >\r\n            <span>暂不更新</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </ConfirmMask>\r\n</template>\r\n\r\n<script>\r\nimport DefaultMixins from '../../mixins/default'\r\n\r\nexport default {\r\n  name: 'UpdateConfirmQingmu',\r\n  mixins: [DefaultMixins]\r\n}\r\n\r\n</script>","<!--\r\n * @Description: \r\n * @Author: 舌红\r\n * @Date: 2024-02-19 13:42:54\r\n * @LastEditors: 舌红\r\n * @LastEditTime: 2024-02-27 18:53:50\r\n-->\r\n<template>\r\n  <div class=\"confirm-mask update-confirm-loader\">\r\n    <slot />\r\n  </div>\r\n</template>","import { render } from \"./mask.vue?vue&type=template&id=228608f1\"\nconst script = {}\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","/*\r\n * @Description: \r\n * @Author: 舌红\r\n * @Date: 2024-02-19 13:49:58\r\n * @LastEditors: 舌红\r\n * @LastEditTime: 2024-02-20 11:14:23\r\n */\r\nimport ConfirmMask from '../layout/mask.vue'\r\n\r\nexport default {\r\n  components: {\r\n    ConfirmMask\r\n  },\r\n  props: {\r\n    content: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    type: {\r\n      type: String,\r\n      default: 'qingmu'\r\n    }\r\n  },\r\n  methods: {\r\n    cancel() {\r\n      this.$emit('cancel')\r\n    },\r\n    confirm() {\r\n      this.$emit('confirm')\r\n    }\r\n  }\r\n}","import { render } from \"./qingmu.vue?vue&type=template&id=65a28e1d\"\nimport script from \"./qingmu.vue?vue&type=script&lang=js\"\nexport * from \"./qingmu.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<!--\r\n * @Description: \r\n * @Author: 舌红\r\n * @Date: 2024-01-10 17:01:44\r\n * @LastEditors: 舌红\r\n * @LastEditTime: 2024-02-23 14:44:12\r\n-->\r\n<template>\r\n  <ConfirmMask>\r\n    <div class=\"confirm-element__wrapper\">\r\n      <div class=\"confirm-element__header\">\r\n        <div class=\"confirm-element__title\">\r\n          提示\r\n        </div>\r\n        <div\r\n          class=\"confirm-element__close\"\r\n          @click=\"cancel\"\r\n        >\r\n          &times;\r\n        </div>\r\n      </div>\r\n      <div class=\"confirm-element__content\">\r\n        <div class=\"confirm-element__desc\">\r\n          {{ content }}\r\n        </div>\r\n      </div>\r\n      <div class=\"confirm-element__btns\">\r\n        <div\r\n          class=\"confirm-element__btn confirm-element__btn--default\"\r\n          @click=\"cancel\"\r\n        >\r\n          取消\r\n        </div>\r\n        <div\r\n          class=\"confirm-element__btn confirm-element__btn--primary\"\r\n          @click=\"confirm\"\r\n        >\r\n          确定\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </ConfirmMask>\r\n</template>\r\n\r\n<script>\r\nimport DefaultMixins from '../../mixins/default'\r\n\r\nexport default {\r\n  name: 'UpdateConfirmElement',\r\n  mixins: [DefaultMixins]\r\n}\r\n</script>","import { render } from \"./element.vue?vue&type=template&id=26c0f2be\"\nimport script from \"./element.vue?vue&type=script&lang=js\"\nexport * from \"./element.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./index.vue?vue&type=template&id=34ebd655\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","/*\r\n * @Description:\r\n * @Author: 舌红\r\n * @Date: 2024-01-10 11:59:14\r\n * @LastEditors: 舌红\r\n * @LastEditTime: 2024-02-20 09:58:41\r\n */\r\nimport { modalPromise } from '../../utils/modalPromise'\r\nimport ConfirmDialog from './index.vue'\r\n\r\nexport async function openConfirm(config, mountedEl) {\r\n  return modalPromise(ConfirmDialog, config, mountedEl)()\r\n}\r\n","/*\r\n * @Description:\r\n * @Author: 舌红\r\n * @Date: 2024-01-09 17:38:09\r\n * @LastEditors: 舌红\r\n * @LastEditTime: 2024-02-22 10:04:29\r\n */\r\n\r\nimport { openConfirm } from './components/confirm/confirm'\r\n\r\n/**\r\n * 监听版本更新\r\n * @param {Object} Vue Vue对象\r\n * @param {Object} options 配置对象\r\n * @param {String} options.versionUrl 请求版本信息根目录路径，默认为'/dist'\r\n * @param {Number} options.interval 检查更新间隔时间，默认为5分钟，单位为毫秒\r\n * @param {Boolean} options.isTip 是否提示更新，默认为true\r\n * @param {Boolean} options.isListenJSError 是否监听JS报错，默认为false\r\n * @param {Object} options.modalProps 弹窗配置\r\n * @param {String} options.modalProps.content 弹窗内容\r\n * @param {Element} options.modalProps.mountedEl 弹窗挂载节点，默认为body\r\n * @param {String} options.type 弹窗样式类型，默认为'qingmu', 可选值为'element'、'qingmu'、'custom'(暂不支持)\r\n * @param {Boolean} options.showTest 弹窗常显测试\r\n * @returns {Void} 无返回值\r\n */\r\n\r\nconst ListenVersion = {\r\n  install(Vue, options) {\r\n    let currebtVersion\r\n    let setInterValId\r\n    let isUpdate = false\r\n\r\n    // 获取版本信息\r\n    const getVersion = async () => {\r\n      return fetch(`${options.versionUrl || '/dist'}/version.json?timeStamp=` + Date.now()).then(res => {\r\n        return res.json()\r\n      }).catch(err => {\r\n        console.log(err)\r\n      })\r\n    }\r\n\r\n    // 检查是否有新版本\r\n    const checkUpdate = async () => {\r\n      const commitHash = (await getVersion()).commitHash\r\n      return commitHash !== currebtVersion\r\n    }\r\n\r\n    // 停止检查更新\r\n    const stopUpdate = () => {\r\n      if (setInterValId) {\r\n        console.log('停止检查更新')\r\n        clearInterval(setInterValId)\r\n        setInterValId = ''\r\n      }\r\n    }\r\n\r\n    // 开始检查更新\r\n    const startListen = async () => {\r\n      if (!options.showTest && (options.isTip === false || process.env.NODE_ENV === 'development')) return\r\n      const versionInfo = await getVersion()\r\n      if (!versionInfo || isUpdate) return\r\n      currebtVersion = versionInfo.commitHash\r\n      console.log('开始检查更新')\r\n      setInterValId = setInterval(async () => {\r\n        isUpdate = options.showTest || (await checkUpdate())\r\n        // 判断versionInfo.message是否有--no-tip字符，如果有则不提示更新\r\n        if ((isUpdate && versionInfo.isTip) || options.showTest) {\r\n          console.log('有新版本')\r\n          stopUpdate()\r\n          await callConfirm()\r\n        }\r\n      }, options.interval || 5 * 60 * 1000)\r\n    }\r\n\r\n    const callConfirm = async () => {\r\n      try {\r\n        const hasContent = options.modalProps && options.modalProps.content\r\n        await openConfirm({\r\n          content: hasContent ? options.modalProps.content : '为了更好的版本体验请更新到最新版本',\r\n          type: options.type || 'qingmu',\r\n        }, options.modalProps && options.modalProps.mountedEl)\r\n        window.location.reload()\r\n      } catch (error) {\r\n        console.log(error)\r\n      }\r\n    }\r\n\r\n    const listenPageVisible = () => {\r\n      if (document.hidden) {\r\n        stopUpdate()\r\n      } else {\r\n        startListen()\r\n      }\r\n    }\r\n\r\n    document.addEventListener('visibilitychange', listenPageVisible)\r\n\r\n    const listenJSError = async (event) => {\r\n      if (event.target.nodeName === 'SCRIPT') {\r\n        stopUpdate()\r\n        await callConfirm()\r\n      }\r\n    }  \r\n\r\n    if (options.isListenJSError) {\r\n      window.addEventListener('error', listenJSError)\r\n    }\r\n\r\n    startListen()\r\n  }\r\n}\r\n\r\nexport default ListenVersion\r\n","/*\r\n * @Description: \r\n * @Author: 舌红\r\n * @Date: 2024-01-10 16:16:52\r\n * @LastEditors: 舌红\r\n * @LastEditTime: 2024-02-19 18:49:54\r\n */\r\nimport ListenerLoader from \"./updateListener/index.js\"\r\nimport './updateListener/theme-chalk/index.scss'\r\n\r\n/**\r\n * 监听版本更新\r\n * @param {Object} Vue Vue对象\r\n * @param {Object} options 配置对象\r\n * @param {String} options.versionUrl 请求版本信息根目录路径，默认为'/dist'\r\n * @param {Number} options.interval 检查更新间隔时间，默认为5分钟，单位为毫秒\r\n * @param {Boolean} options.isTip 是否提示更新，默认为true\r\n * @param {Boolean} options.isListenJSError 是否监听JS报错，默认为false\r\n * @param {Object} options.modalProps 弹窗配置\r\n * @param {String} options.modalProps.content 弹窗内容\r\n * @param {Element} options.modalProps.mountedEl 弹窗挂载节点，默认为body\r\n * @param {String} options.type 弹窗样式类型，默认为'qingmu', 可选值为'element'、'qingmu'、'custom'(暂不支持)\r\n * @param {Boolean} options.showTest 弹窗常显测试\r\n * @returns {Void} 无返回值\r\n */\r\n\r\nexport default ListenerLoader\r\n\r\n","import './setPublicPath'\nimport mod from '~entry'\nexport default mod\nexport * from '~entry'\n"],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE__274__","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","p","window","currentScript","document","src","match","modalPromise","comp","defaultConfig","mountedEl","config","removable","Promise","resolve","reject","assign","vm","createVNode","onCancel","onConfirm","body","render","parentNode","querySelector","data","remove","_createBlock","_resolveDynamicComponent","$data","confirmTypeNames","_ctx","type","content","confirm","cancel","class","_createElementVNode","_hoisted_7","_component_ConfirmMask","default","_withCtx","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_toDisplayString","_hoisted_6","onClick","_cache","args","_hoisted_8","_","_createElementBlock","_renderSlot","$slots","script","__exports__","components","ConfirmMask","String","methods","$emit","name","mixins","DefaultMixins","UpdateConfirmQingmu","UpdateConfirmElement","qingmu","element","async","openConfirm","ConfirmDialog","ListenVersion","install","Vue","options","currebtVersion","setInterValId","isUpdate","getVersion","fetch","versionUrl","Date","now","then","res","json","catch","err","console","log","checkUpdate","commitHash","stopUpdate","clearInterval","startListen","showTest","isTip","versionInfo","setInterval","callConfirm","interval","hasContent","modalProps","location","reload","error","listenPageVisible","hidden","addEventListener","listenJSError","event","nodeName","isListenJSError"],"sourceRoot":""}